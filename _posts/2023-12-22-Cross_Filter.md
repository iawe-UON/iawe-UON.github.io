---
title: '推荐算法1：协同过滤'
date: 2023-12-22
permalink: /posts/2023/12/Cross_Filter/
tags:
  - RecSys
---

协同过滤算法——最早的推荐算法
------------
1. 时间点：协同过滤算法最早在2003年由Amazon公司发表的论文《Amazon.com Recommenders Item-to-Item
   Collaborative Filtering》中被首次提出，但是在更早的1992年，Xerox便已经在邮件过滤系统中研究和应用协同过滤的相关算法

   

   协同过滤的基本原理是基于一种直观的，符合人们普遍认知的一种思维模式来进行相关物品（item）对相关用户（user）的推荐：

   ”相似的人会倾向于喜欢相似的东西“


2. 协同过滤的模式图：

<img src="./image/Cross filter.png"/>
如上图所示，（a）表示待选的相关物品，（b）表示的是目前已经收集到的用户购买物品的相关信息和是否对某个用户进行推荐的信息，也就是我们想要预测的目标（图中是加粗的那一条箭头，表示是否将电视推荐给最下面的用户）

基于以上建模出来的有向图结构，我们可以将其转化成有向图的邻接矩阵，之后也会称其为”共现矩阵“，后续所有的操作都是基于共现矩阵来实现的。可以看见，现在我们要预测的是问号区域是推荐还是不推荐（0/1的判断）

根据除问号方框外的其他区域，我们可以得出A，B用户跟X用户是最接近的，也就是最相似的。后续一般会使用KNN来找出最相近的top K用户来进行预测。根据找出的两个相似用户对于电视的评价，发现都是负评价，可以预测，问号部分也都是负评价。

最后在（d）图中，我们根据预测的结果不对用户X进行视频的推荐，因为预测是负评价



作为最基础，也是最先出现并进行研究和应用的推荐系统算法，CF在推荐算法发展的道路上起到了举足轻重的作用，后续在深度学习时代，很多的深度学习算法也都是基于CF的思想来进行实现的



3.  缺陷和局限：

   （1）对于正负评价体系来说，最简单的方式是将其转化成独热编码（one - hot），导致共现矩阵必定是稀疏矩阵，这对于模型的泛化性能是一个巨大的打击。

   （2）根据实际应用场景来说，用户数必然大于物品数，所以维护一个用户相似度矩阵的话开销巨大，难以承受



itemCF（维护物品共现矩阵的协同过滤算法）
-----------------

为了弥补第二种缺陷，人们考虑将维护用户信息改为维护物品信息，从而减少用户相似度矩阵的数据规模，节约计算以及储存的开销。

处理模式如下：

（1）维护 $m × n$ 的共现矩阵（用户数为 $m$ ，物品数为 $n$ ）

（2）维护一个 $ n×n $ 的物品相似度矩阵，使用皮尔逊相关系数或者是余弦相似度都可以

（3）获取目标用户历史行为数据中正反馈物品列表

（4）利用物品相似度矩阵，找出相似的top K个物品 组成相似物品集合（召回）

（5）在top K个物品中，对其进行排序，生成推荐列表

在第5 步中，如果一个物品与多个用户行为历史中的正反馈物品相似，那么该物品最终的相似度应该是多个相似度的累加

$$R_{u,p} = \Sigma_{h\in H}(w_{p,h} \cdot R_{u,h}) $$

其中， $H$ 是目标用户的正反馈物品集合, $W_{p,h}$是物品p与物品h的物品相似度, $R_{u,h}$是用户u 对物品h 的已有评分











